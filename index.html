<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ubuntu Emulator ‚Äî Fixed</title>
  <style>
    body {
      margin: 0;
      font-family: 'Ubuntu', sans-serif;
      background: url('https://upload.wikimedia.org/wikipedia/commons/0/0d/Ubuntu_22.04_LTS_Default_Wallpaper.svg') center/cover no-repeat;
      color: #eee;
      overflow: hidden;
    }
    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 38px;
      background: rgba(30,30,30,0.6);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 12px;
      color: #eee;
      z-index: 1000;
    }
    .dock {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: rgba(20,20,20,0.5);
      backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 16px;
    }
    .dock .icon {
      font-size: 24px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .dock .icon:hover {
      transform: scale(1.2);
    }
    .window {
      position: absolute;
      background: rgba(40,40,40,0.6);
      backdrop-filter: blur(8px);
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      color: #eee;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .window-header {
      display: flex;
      align-items: center;
      background: rgba(20,20,20,0.4);
      padding: 6px 10px;
      cursor: grab;
    }
    .window-body {
      flex: 1;
      padding: 10px;
      overflow: auto;
    }
    .terminal {
      background: #0b0f14;
      color: #c8f7c8;
      font-family: monospace;
      padding: 10px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <div class="top-bar">Ubuntu Emulator</div>
  <div class="dock">
    <div class="icon" data-app="terminal">üíª</div>
    <div class="icon" data-app="files">üìÅ</div>
    <div class="icon" data-app="notes">üìù</div>
  </div>

  <div id="windows"></div>

  <script>
    const windowsEl = document.getElementById('windows');
    let zIndex = 10;

    const apps = {
      terminal: {
        title: 'Terminal',
        content: `<div class='terminal'><div id='term-output'>user@ubuntu:~$ <br></div><input id='term-input' style='width:100%;background:transparent;border:none;color:inherit;outline:none;'></div>`
      },
      files: {
        title: 'Files',
        content: `<div>üìÑ file1.txt<br>üìÑ file2.png</div>`
      },
      notes: {
        title: 'Notes',
        content: `<textarea style='width:100%;height:100%;background:transparent;border:none;color:#eee;outline:none;'>Type notes here...</textarea>`
      }
    };

    document.querySelectorAll('.icon').forEach(icon => {
      icon.addEventListener('click', () => {
        openApp(icon.dataset.app);
      });
    });

    function openApp(appName) {
      const app = apps[appName];
      if (!app) return;
      const win = document.createElement('div');
      win.className = 'window';
      win.style.top = `${60 + Math.random()*100}px`;
      win.style.left = `${60 + Math.random()*100}px`;
      win.style.width = '400px';
      win.style.height = '300px';
      win.style.zIndex = ++zIndex;
      win.innerHTML = `<div class='window-header'>${app.title}</div><div class='window-body'>${app.content}</div>`;
      windowsEl.appendChild(win);
      makeDraggable(win);
      if (appName === 'terminal') bindTerminal(win);
    }

    function makeDraggable(win) {
      const header = win.querySelector('.window-header');
      header.addEventListener('mousedown', e => {
        let startX = e.clientX, startY = e.clientY;
        let rect = win.getBoundingClientRect();
        function move(ev) {
          win.style.left = rect.left + (ev.clientX - startX) + 'px';
          win.style.top = rect.top + (ev.clientY - startY) + 'px';
        }
        function up() {
          window.removeEventListener('mousemove', move);
          window.removeEventListener('mouseup', up);
        }
        window.addEventListener('mousemove', move);
        window.addEventListener('mouseup', up);
      });
    }

    function bindTerminal(win) {
      const input = win.querySelector('#term-input');
      const output = win.querySelector('#term-output');
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          const cmd = input.value.trim();
          input.value = '';
          output.innerHTML += `$ ${cmd}<br>`;
          if (cmd === 'help') output.innerHTML += 'Commands: help, date, clear, echo &lt;text&gt;<br>';
          else if (cmd === 'date') output.innerHTML += new Date().toString() + '<br>';
          else if (cmd === 'clear') output.innerHTML = 'user@ubuntu:~$ <br>';
          else if (cmd.startsWith('echo ')) output.innerHTML += cmd.slice(5) + '<br>';
          else output.innerHTML += `Command not found: ${cmd}<br>`;
          output.scrollTop = output.scrollHeight;
        }
      });
    }
  </script>
</body>
</html>
